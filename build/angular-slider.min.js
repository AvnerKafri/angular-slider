/*! angular-slider 2013-09-24 */
angular.module("vr.directives.slider",[]).directive("slider",["$timeout","$document","$interpolate",function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return p=3,d=function(a){return angular.element(a)},k=function(a){return""+a+"px"},h=function(a){return a.css({opacity:0})},n=function(a){return a.css({opacity:1})},i=function(a,b){return a.css({left:b})},g=function(a){return o(a)/2},j=function(a){try{return a.offset().left}catch(b){}var c=a[0],d=document.documentElement||document.body,e=window.pageXOffset||d.scrollLeft;return c.getBoundingClientRect().left+e},o=function(a){var b=parseFloat(a.css("width"));return isNaN(b)?a[0].offsetWidth:b},f=function(a,b){return j(b)-j(a)-o(a)},e=function(a,b){return a.attr("ng-bind-template",b)},l=function(a,b,c,d,e){var f,g,h,i;return(null==c||0==c)&&(c=1/Math.pow(10,b)),null==d&&(d=0),(null==a||isNaN(a))&&(a=0),g=(a-d)%c,i=g>c/2?a+c-g:a-g,f=Math.pow(10,b),h=i*f/f,null==e&&(e=h),h=d>h?d:h>e?e:h,parseFloat(h.toFixed(b))},m=function(a,b){return a>0&&!isNaN(b)?Math.ceil(b/a)*a:b},{restrict:"EA",scope:{floor:"@",ceiling:"@",step:"@",precision:"@",buffer:"@",stretch:"@",ngModel:"=",ngModelLow:"=",ngModelHigh:"=",translate:"&"},template:"<span class='bar full'></span><span class='bar selection'></span><span class='bar unselected low'></span><span class='bar unselected high'></span><span class='pointer low'></span><span class='pointer high'></span><span class='bubble low'></span><span class='bubble high'></span><span class='bubble middle'></span><span class='bubble selection'></span><span class='bubble limit floor'></span><span class='bubble limit ceiling'></span>",compile:function(q,r){var s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P;if(r.translate&&r.$set("translate",""+r.translate+"(value)"),B=null==r.ngModel&&null!=r.ngModelLow&&null!=r.ngModelHigh,M=function(){var a,b,c,e;for(c=q.children(),e=[],a=0,b=c.length;b>a;a++)u=c[a],e.push(d(u));return e}(),w=M[0],F=M[1],G=M[2],H=M[3],A=M[4],z=M[5],y=M[6],x=M[7],t=M[8],I=M[9],v=M[10],s=M[11],D=B?"ngModelLow":"ngModel",C="ngModelHigh",E="selectBar",O=c.startSymbol(),P=c.endSymbol(),e(s,O+" translation(ceiling) "+P),e(v,O+" translation(floor) "+P),e(I,"Range: "+O+" translation(diff) "+P),e(y,O+" translation("+D+")"+P),e(x,O+" translation("+C+") "+P),e(t,O+" translation("+D+") "+P+" - "+O+" translation("+C+") "+P),!B)for(N=[F,G,H,z,I,x,t],K=0,L=N.length;L>K;K++)q=N[K],q.remove();return J=[D,"floor","ceiling"],B&&(J.push(C),J.push("buffer")),{post:function(c,d,e){c.translation=function(a){return a=parseFloat(a).toFixed(c.precision),angular.isUndefined(e.translate)?""+a:c.translate({value:a})};var q,r,u,K,L,M,N,O,P,Q,R,S,T,U,V=0,W=0;for(r=!1,P=q=M=K=N=L=R=O=void 0,u=function(){var a,b,d,f;for(angular.isUndefined(c.precision)&&(c.precision=0),angular.isUndefined(c.step)&&(c.step=0),c.buffer=f=m(parseFloat(c.step),parseFloat(c.buffer)),c.floor=parseFloat(c.floor),c.ceiling=parseFloat(c.ceiling),b=0,d=J.length;d>b;b++)a=J[b],(a==D||a==C)&&(c[a]=l(parseFloat(c[a]),parseFloat(c.precision),parseFloat(c.step),parseFloat(c.floor),parseFloat(c.ceiling)));if(B&&parseFloat(c[C])<parseFloat(c[D])){var h=c[C];c[C]=c[D],c[D]=h}if(B&&(c.diff=l(c[C]-c[D],parseFloat(c.precision),parseFloat(c.step)),f>0&&c.diff<f)){var i=(parseFloat(c[D])+parseFloat(c[C]))/2;c[D]=l(i-f/2,parseFloat(c.precision),parseFloat(c.step),parseFloat(c.floor),parseFloat(c.ceiling)),c[C]=parseFloat(c[D])+f,c[C]>c.ceiling&&(c[D]-=f,c[C]=c.ceiling),c.diff=f}return P=g(A),q=o(w),M=j(w),K=M+q-o(A),N=parseFloat(e.floor),L=parseFloat(e.ceiling),R=L-N,O=K-M},Q=function(){var a,e,J,L,Q,S,T,U,X,Y,Z,$,_,ab,bb,cb,db,eb,fb;u(),i(v,0),i(s,k(q-o(s))),J=function(a){return 100*((a-M)/O)},L=function(a){return(a-N)/R*O+M},S=function(a){return 100*((a-N)/R)},Q=function(a){return k(a*O/100)},e=function(a){return i(a,Q(J(Math.min(Math.max(M,j(a)),K))))},X=function(a,b,d){var e=a>0?1:-1;if(b=0==b?100:b,d)return(Math.sin(Math.min(Math.abs(a/b),1)*Math.PI-Math.PI/2)+1)*e*b/6;var f=c.stretch?parseInt(c.stretch):p;return e*Math.pow(Math.min(Math.abs(2*(a/b)),1),f)*b/2},U=function(){var a,b,d,e,f,h,k,l;return f=S(parseFloat(c.step)+N),h=S(m(parseFloat(c.step),parseFloat(c.buffer))+N),b=S(c[D]),d=b+X(V,f),i(A,Q(d)),i(y,Q(J(j(A)-g(y)+P))),B?(a=S(c[C]),d>a-h&&(d=b+X(V,h,!0),i(A,Q(d)),i(y,Q(J(j(A)-g(y)+P)))),e=a+X(W,f),b+h>e&&(e=a+X(W,h,!0)),i(z,Q(e)),i(x,Q(J(j(z)-g(x)+P))),l=J(P+M),k=d+l,i(F,Q(k)),F.css({width:Q(e-d)}),G.css({left:0,width:Q(d+l)}),i(H,Q(e+l)),H.css({right:0}),i(I,Q(k+J(g(F)-g(I)+M))),i(t,Q(k+J(g(F)-g(t)+M)))):void 0},a=function(){var a;return e(y),a=x,B&&(e(x),e(I),f(y,x)<10?(h(y),h(x),e(t),n(t),a=t):(n(y),n(x),h(t),a=x)),f(v,y)<5?h(v):B?f(v,a)<5?h(v):n(v):n(v),f(y,s)<5?h(s):B?f(a,s)<5?h(s):n(s):n(s)},Y=function(){V=0,W=0,eb&&(U(),a(),eb.removeClass("active")),eb=null,fb=null,_=!1},Z=function(b){if(eb){var e,f,h,i,k;k=m(parseFloat(c.step),parseFloat(c.buffer)),e=b.clientX||b.originalEvent.clientX||b.touches[0].clientX,_?(cb=e-ab,db=e+bb,M>cb?(db+=M-cb,cb=M):db>K&&(cb-=db-K,db=K),cb=J(cb),db=J(db),V=cb,cb=N+R*cb/100,db=N+R*db/100,cb=l(cb,parseFloat(c.precision),parseFloat(c.step),parseFloat(c.floor),parseFloat(c.ceiling)),db=l(db,parseFloat(c.precision),parseFloat(c.step),parseFloat(c.floor),parseFloat(c.ceiling)),c[D]=cb,c[C]=db,V=W=V-S(cb)):(f=e+M-j(d)-g(eb),f=Math.max(Math.min(f,K),M),h=J(f),V=h,i=N+R*h/100,B&&(k>0?i=fb===D?i>parseFloat(c[C])-k?parseFloat(c[C])-k:i:i<parseFloat(c[D])+k?parseFloat(c[D])+k:i:fb===D?i>c[C]&&(fb=C,A.removeClass("active"),z.addClass("active")):i<c[D]&&(fb=D,z.removeClass("active"),A.addClass("active"))),i=l(i,parseFloat(c.precision),parseFloat(c.step),parseFloat(c.floor),parseFloat(c.ceiling)),c[fb]=i,fb===D?V-=S(i):(W=V-S(i),V=0)),U(),a(),c.$apply()}},$=function(b,e,f){eb=e,fb=f,eb.addClass("active");var h=b.clientX||b.originalEvent.clientX||b.touches[0].clientX;fb==E&&(_=!0,ab=h-L(c[D])-g(A),bb=L(c[C])-h+g(z));var i=h+M-j(d);i=Math.max(Math.min(i,K),M);var k=N+R*J(i)/100;k=l(k,parseFloat(c.precision),parseFloat(c.step),parseFloat(c.floor),parseFloat(c.ceiling)),c[fb]=k,U(),a(),c.$apply(),u()},T=function(){var a=function(a,b,c){a=angular.element(a),c=angular.isUndefined(c)?a:angular.element(c);var d=function(a){$(a,c,b)};window.navigator.msPointerEnabled?a.bind("MSPointerDown",d):a.bind("mousedown touchstart",d)},c=function(a){a=angular.element(a),window.navigator.msPointerEnabled?(a.bind("MSPointerMove",Z),a.bind("MSPointerUp",Y)):(a.bind("mousemove touchmove",Z),a.bind("mouseup touchend",Y))};a(A,D),a(z,C),a(y,D),a(x,C),a(v,D,A),B?(a(s,C,z),a(F,E),a(I,E,F),a(G,D,A),a(H,C,z)):(a(s,D,A),a(w,D,A)),c(b)},U(),a(),r||(T(),r=!0)},a(Q),T=0,U=J.length;U>T;T++)S=J[T],c.$watch(S,Q);angular.element(window).bind("resize",Q)}}}}}]);